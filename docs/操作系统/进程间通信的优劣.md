# 进程通信方法的特点以及使用场景 

## 1. 什么是进程间通信

因为每个进程各自有不同的用户地址空间，任何一个进程的全局变量在另一个进程中都看不到，所以进程之间要交换数据必须通过内核，在内核中开辟一块缓冲区，进程1把数据从用户空间拷到内核缓冲区，进程2再从内核缓冲区把数据读走，内核提供的这种机制称为**进程间通信（IPC，InterProcess Communication）**

<div align="center">
    <img src="https://s2.ax1x.com/2020/02/14/1jTXiq.jpg" width="960px">
</div> 

## 2. 进程间通信的方法

- （匿名）管道 Pipe

  - 半双工，即数据只能单向流动，两个进程间通信时需要建立两个管道
  - 由于匿名，只能在有亲缘关系（有公共祖先）的进程间使用，如父子进程、兄弟进程
  - 数据读写操作：一个进程从管道尾部写入数据，另一个进程从管道头部读出数据

- 命名管道 Named pipe

  - 半双工
  - 克服了匿名管道没有名字的限制，因此可以通过路径名在无亲缘关系的进程间通信

- 消息队列 Message Queue

  即数据块的链表，允许一个或多个进程向它写入数据，允许一个或多个进程从它读出数据

  消息队列克服了管道缓冲区大小受限的缺点，避免了管道的同步和阻塞问题，但是每个数据块依旧有一个最大长度的限制

- 共享内存 shared memory

  因为操作系统分配给每个进程的内存地址并不是实际的物理地址，而是虚拟地址，所以将两个进程各拿出一块虚拟地址映射到相同的物理地址，那么两个进程就可以直接读写内存而不用进行数据的拷贝

- 信号量 semaphore

  和其他IPC方法直接将数据从一个进程传递到另一个进程不同，信号量是一种控制多个进程对共享资源的访问，一种锁机制 。

  其本质是一个计数器，比如信号量初始值为0，当进程1来访问内存a时，信号量将被置为1，这是当另一个进程2要来访问相同的内存a时，由于发现信号量为1，就知道已经有进程在访问内存a，因此会被互斥。所以某种意义上来说，信号量也是IPC的一种。

- 信号 Signal

  信号用来通知进程发生了异步事件。有两种发送信号的方式可以通知进程一系列预定好的事件：

  1. 进程间互相通过系统调用发送信号
  2. 内核由于没写内部事件向进程发送信号

  接收到信号的进程可以根据不同的方式处理信号，比如：

  1. 类似中断的处理程序，对于需要处理的信号，进程可以指定相应的处理函数
  2. 忽略某个信号，对该信号不做任何处理
  3. 对该信号的处理采取系统默认措施（大部分信号的默认处理是终止进程）

  举个常见的例子，比如当我们在terminal中按下`CTRL+C`时，terminal就将产生`SIGINT`信号，前台进程组中所有的进程都会收到`SIGINT`信号然后退出。

- 套接字 Socket

  可用于不同机器之间的进程通信